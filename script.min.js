<canvas id="litw"></canvas><script>function $(a){return document.getElementById(a)};$("litw").style.backgroundColor="black";var cW=document.documentElement.clientWidth,cH=document.documentElement.clientHeight;var ctx=null;var tileW=cH/10,tileH=cH/10;var mapW=10,mapH=10;var currentSecond=0,frameCount=0,frameLastSecond=0;var lastFrameTime=0;$("litw").setAttribute("width",cW);$("litw").setAttribute("height",cH);tileW=cH/10,tileH=cH/10;var keysDown={37:false,38:false,39:false,40:false};var player=new Character();var gameMap=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,0,1,1,0,0,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,0,1,0,0,1,0,1,0,1,0,0,0,1,1,1,0,1,0,1,1,0,0,1,1,1,1,1,1,1,1,0,0,1,1,1,0,1,0,1,1,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,2,];function Character(){this.tileFrom=[1,1];this.tileTo=[1,1];this.timeMoved=0;this.dimensions=[tileW,tileH];this.position=[tileW,tileH];this.delayMove=400}Character.prototype.placeAt=function(a,b){this.tileFrom=[a,b];this.tileTo=[a,b];this.position=[((tileW*a)+((tileW-this.dimensions[0])/2)),((tileW*b)+((tileW-this.dimensions[1])/2))]};Character.prototype.processMovement=function(a){if(this.tileFrom[0]==this.tileTo[0]&&this.tileFrom[1]==this.tileTo[1]){return false}if((a-this.timeMoved)>=this.delayMove){this.placeAt(this.tileTo[0],this.tileTo[1])}else{this.position[0]=(this.tileFrom[0]*tileW)+((tileW-this.dimensions[0])/2);this.position[1]=(this.tileFrom[1]*tileH)+((tileW-this.dimensions[1])/2);if(this.tileTo[0]!=this.tileFrom[0]){var b=(tileW/this.delayMove)*(a-this.timeMoved);this.position[0]+=(this.tileTo[0]<this.tileFrom[0]?0-b:b)}if(this.tileTo[1]!=this.tileFrom[1]){var b=(tileH/this.delayMove)*(a-this.timeMoved);this.position[1]+=(this.tileTo[1]<this.tileFrom[1]?0-b:b)}this.position[0]=Math.round(this.position[0]);this.position[1]=Math.round(this.position[1])}return true};function toIndex(a,b){return((b*mapW)+a)}window.onload=function(){ctx=$("litw").getContext("2d");requestAnimationFrame(drawGame);ctx.font="bold 10pt sans-serif";window.addEventListener("keydown",function(a){var b=a.keyCode;if(b>=37&&b<=40){keysDown[b]=true}});window.addEventListener("keyup",function(a){var b=a.keyCode;if(b>=37&&b<=40){keysDown[b]=false}})};function drawGame(){if(ctx==null){return}var d=Date.now();var c=d-lastFrameTime;var b=Math.floor(Date.now()/1000);if(b!=currentSecond){currentSecond=b;frameLastSecond=frameCount;frameCount=1}else{frameCount++}if(!player.processMovement(d)){if(keysDown[37]&&player.tileFrom[0]>0&&gameMap[toIndex(player.tileFrom[0]-1,player.tileFrom[1])]==1){player.tileTo[0]-=1}else{if(keysDown[38]&&player.tileFrom[1]>0&&gameMap[toIndex(player.tileFrom[0],player.tileFrom[1]-1)]==1){player.tileTo[1]-=1}else{if(keysDown[39]&&player.tileFrom[0]<(mapW-1)&&gameMap[toIndex(player.tileFrom[0]+1,player.tileFrom[1])]==1){player.tileTo[0]+=1}else{if(keysDown[40]&&player.tileFrom[1]<(mapH-1)&&gameMap[toIndex(player.tileFrom[0],player.tileFrom[1]+1)]==1){player.tileTo[1]+=1}}}}if(player.tileFrom[0]!=player.tileTo[0]||player.tileFrom[1]!=player.tileTo[1]){player.timeMoved=d}}for(var f=0;f<mapH;f++){for(var a=0;a<mapW;a++){switch(gameMap[((f*mapW)+a)]){case 0:ctx.fillStyle="#3A0";break;case 1:ctx.fillStyle="#650";break;default:}ctx.fillRect(a*tileW,f*tileH,tileW,tileH)}}ctx.fillStyle="#0000ff";function e(j){var i=["#000","#431","#49B"];var h=[[0,0,0,0,0,1,1,1],[0,0,0,0,1,1,1,1],[0,0,0,1,1,1,1,1],[0,0,0,1,1,1,1,1],[0,0,0,1,1,1,1,1],[0,0,0,1,1,1,1,1],[0,0,0,0,1,1,1,1],[0,0,0,2,2,1,1,1]];if(j=="S"){for(var k=0;k<h.length;k++){for(var g=0;g<h[k].length;g++){ctx.fillStyle=i[h[k][g]];ctx.fillRect(Math.floor(player.position[0]+g*(tileH/16)),Math.round(player.position[1]+k*(tileH/16)),tileH/16,tileW/16)}}}if(j=="L"){}if(j=="R"){for(var k=0;k<h.length;k++){for(var g=0;g<h[k].length;g++){ctx.fillStyle=i[h[k][g]];ctx.fillRect(player.position[0]+g*(tileH/16),player.position[1]+k*(tileH/16),tileH/16,tileW/16)}}}}if(keysDown[37]){e("L")}else{if(keysDown[38]){}else{if(keysDown[39]){e("R")}else{if(keysDown[40]){}}}}if(!(keysDown[37]&&keysDown[38]&&keysDown[39]&&keysDown[40])){e("S")}ctx.fillStyle="#ff0000";ctx.fillText("FPS: "+frameLastSecond,10,20);lastFrameTime=d;requestAnimationFrame(drawGame)};